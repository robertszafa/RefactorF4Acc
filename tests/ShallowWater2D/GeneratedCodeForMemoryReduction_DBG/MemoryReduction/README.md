The difference with the OpenCL-style code is that I have inlined the parameters, in particular j_range and k_range, because somehow they did not get folded.
